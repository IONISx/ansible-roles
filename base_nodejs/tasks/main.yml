- name: add nodejs ppa
  apt_repository: >-
     repo={{ base_nodejs_ppa }}

- name: install apt packages
  apt: >-
    pkg={{ item }}
  with_items: base_nodejs_apt_pkgs

- name: install nodejs
  apt: >-
    pkg=nodejs

- name: set npm registry
  shell:
    npm config --global set registry "{{ mirror_npm_url }}"
  when: mirror_npm_url is defined and mirror_npm_url

- name: unset npm registry
  shell:
    npm config --global delete registry
  when: mirror_npm_url is not defined or not mirror_npm_url
